<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Outcomes</title>
    <style>
        .outcome-item {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .outcome-item p {
            margin: 5px 0;
        }
    </style>
    <!-- Load Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
</head>
<body>




    <h1>Sales Outcomes</h1>





    <div id="sales-outcomes-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const firebaseConfig = {
                apiKey: "AIzaSyBhSqBwrg8GYyaqpYHOZS8HtFlcXZ09OJA",
                authDomain: "track-dac15.firebaseapp.com",
                databaseURL: "https://track-dac15-default-rtdb.firebaseio.com",
                projectId: "track-dac15",
                storageBucket: "track-dac15.appspot.com",
                messagingSenderId: "495156821305",
                appId: "1:495156821305:web:7cbb86d257ddf9f0c3bce8",
                measurementId: "G-RVBYB0RR06"
            };
            
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const database = firebase.database();
            const provider = new firebase.auth.GoogleAuthProvider();

            function displaySalesOutcomes(user) {
                const outcomesRef = firebase.database().ref('salesOutcomes/' + user.uid);
                outcomesRef.on('value', (snapshot) => {
                    const outcomes = snapshot.val();
                    if (outcomes) {
                        const outcomesContainer = document.getElementById('sales-outcomes-container');
                        outcomesContainer.innerHTML = ''; // Clear previous outcomes

                        for (const key in outcomes) {
                            const outcome = outcomes[key];
                            const outcomeElement = document.createElement('div');
                            outcomeElement.classList.add('outcome-item');

                            outcomeElement.innerHTML = `
                                <p><strong>Outcome Time:</strong> ${outcome.outcomeTime}</p>
                                <p><strong>Assign Action:</strong> ${outcome.assignAction}</p>
                                <p><strong>Notes:</strong> ${outcome.notesValue}</p>
                                <p><strong>Account Number:</strong> ${outcome.accountNumber}</p>
                            `;
                            outcomesContainer.appendChild(outcomeElement);
                        }
                    } else {
                        console.log('No sales outcomes found for user:', user.displayName);
                    }
                }, (error) => {
                    console.error('Error fetching sales outcomes:', error);
                });
            }

            auth.onAuthStateChanged(user => {
                if (user) {
                    displaySalesOutcomes(user);
                } else {
                    auth.signInWithPopup(provider).then((result) => {
                        const user = result.user;
                        displaySalesOutcomes(user);
                    }).catch((error) => {
                        console.error('Authentication error:', error);
                    });
                }
            });
        });
    </script>

 <h2>Want to add the autoTracker?</h2>
 <h2>Right click the button below - add bookmark, name autoTracker (or whatever you would like to name it) or drag the button to the bookmark area on the chrome window. then, before tracking any action in the CRM, click the bookmark, it will need to be clicked anytime the URL changed or anytime you open a new account. in order to help you know if the tracker is active or not, you will see a visual indicator in the ACTIONS tab stating "Tracker Active" </h2>


 <a href="javascript:(function(){function loadScript(src,callback){const script=document.createElement('script');script.src=src;script.onload=callback;script.onerror=function(){console.error('Failed to load script:',src);};document.head.appendChild(script);}function showActiveIndicator(){const existingIndicator=document.getElementById('tracker-active-indicator');if(existingIndicator){existingIndicator.style.display='block';}else{const style=document.createElement('style');style.innerHTML=`#tracker-active-indicator {padding: 8px 20px;color: black;font-size: 16px;font-weight: bold;border-radius: 5px;margin: 0 auto;display: block;width: 90%;text-align: center;position: relative;transition: color 0.5s ease, font-weight 0.5s ease;}#tracker-active-indicator:hover {font-weight: normal;}#tracker-active-indicator:hover .icon {color: black;}#tracker-active-indicator .icon {display: inline-block;margin-left: 10px;transition: color 0.5s ease;color: #28a745;}`;document.head.appendChild(style);const indicator=document.createElement('div');indicator.id='tracker-active-indicator';indicator.innerHTML='Tracker Active<span class="icon">âœ”</span>';const actionsHeader=document.evaluate("//h3[text()='Actions']",document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(actionsHeader){actionsHeader.parentElement.appendChild(indicator);}else{console.error('Actions header element not found');}}}loadScript('https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js',function(){console.log("firebase-app.js loaded");loadScript('https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js',function(){console.log("firebase-auth.js loaded");loadScript('https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js',function(){console.log("firebase-database.js loaded");if(typeof firebase==='undefined'){console.error('Firebase SDK not loaded');return;}console.log("Firebase scripts loaded");const firebaseConfig={apiKey:"AIzaSyBhSqBwrg8GYyaqpYHOZS8HtFlcXZ09OJA",authDomain:"track-dac15.firebaseapp.com",databaseURL:"https://track-dac15-default-rtdb.firebaseio.com",projectId:"track-dac15",storageBucket:"track-dac15.appspot.com",messagingSenderId:"495156821305",appId:"1:495156821305:web:7cbb86d257ddf9f0c3bce8",measurementId:"G-RVBYB0RR06"};firebase.initializeApp(firebaseConfig);const auth=firebase.auth();const database=firebase.database();const provider=new firebase.auth.GoogleAuthProvider();console.log("Firebase initialized");function authenticateUser(){firebase.auth().onAuthStateChanged(user=>{if(user){console.log('Authenticated user:',user.displayName);captureOutcomeData(user);showActiveIndicator();}else{console.log("Prompting user to sign in");firebase.auth().signInWithPopup(provider).then((result)=>{const user=result.user;console.log('Authenticated user:',user.displayName);captureOutcomeData(user);showActiveIndicator();}).catch((error)=>{console.error('Authentication error:',error);});}});}function captureOutcomeData(user){document.querySelectorAll('button.MuiButtonBase-root.MuiButton-root.MuiButton-text.jss578.MuiButton-textPrimary').forEach(button=>{if(button.textContent.trim()==='Apply Action'){button.addEventListener('click',function(){console.log('Button clicked:',this);let outcomeTime=new Date().toISOString();console.log('Outcome Time:',outcomeTime);let assignActionElem=document.querySelector('[role="combobox"] input');let assignAction=assignActionElem?assignActionElem.value:"unknown";console.log('Assign Action:',assignAction);let notesValueElem=document.querySelector('[name="note"]');let notesValue=notesValueElem?notesValueElem.value:"unknown";console.log('Notes Value:',notesValue);let accountNumberElem=document.querySelectorAll('.MuiTypography-root.leadInfoCard__content--truncate.MuiTypography-body2')[1];let accountNumber=accountNumberElem?accountNumberElem.textContent:"unknown";console.log('Account Number:',accountNumber);if(!assignActionElem)console.error('assignActionElem not found');if(!notesValueElem)console.error('notesValueElem not found');if(!accountNumberElem)console.error('accountNumberElem not found');const data={userId:user.uid,outcomeTime:outcomeTime,assignAction:assignAction,notesValue:notesValue,accountNumber:accountNumber};console.log('Data to be recorded:',data);const outcomesRef=firebase.database().ref('salesOutcomes/'+user.uid).push();outcomesRef.set(data).then(()=>{console.log('Outcome recorded for user:',user.displayName);}).catch((error)=>{console.error('Error recording outcome:',error);});});}});console.log("Event listeners added to outcome buttons");}authenticateUser();});});});})();" class="bookmarklet-button">Add Tracker</a>


</body>



</html>